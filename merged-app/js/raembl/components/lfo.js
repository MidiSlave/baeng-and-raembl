// File: js/components/lfo.js
// LFO module component - Updated for SlidePot
import { state } from '../state.js';

export function renderLfoModule() {
    const lfoModule = document.createElement('div');
    lfoModule.id = 'raembl-lfo';
    lfoModule.className = 'module';

    lfoModule.innerHTML = `
        <div class="module-header-container">
            <button class="random-button" id="lfo-random" title="Randomize LFO parameters">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="1" y="1" width="12" height="12" rx="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
                    <circle cx="3.5" cy="3.5" r="0.8" fill="currentColor"/>
                    <circle cx="10.5" cy="3.5" r="0.8" fill="currentColor"/>
                    <circle cx="3.5" cy="7" r="0.8" fill="currentColor"/>
                    <circle cx="10.5" cy="7" r="0.8" fill="currentColor"/>
                    <circle cx="3.5" cy="10.5" r="0.8" fill="currentColor"/>
                    <circle cx="10.5" cy="10.5" r="0.8" fill="currentColor"/>
                </svg>
            </button>
            <div class="module-header" data-info-id="raembl-module-lfo">LFO</div>
            <button class="toggle-button lfo-reset ${state.resetLfoOnBar ? 'active' : ''}" title="Reset LFO on Bar" data-info-id="raembl-lfo-rst">RST</button>
        </div>
        <canvas id="raembl-lfo-canvas" width="135" height="60"></canvas>
        <div class="fader-section">
            <div class="slide-pot-container" data-param-id="lfo.amp" data-info-id="raembl-lfo-amp">
                <div class="slide-pot-label waveform-icon" data-param-label="AMP" title="Amplitude">
                    <svg viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M7.983 8.37c-.053.073-.098.133-.141.194L5.775 11.5c-.64.91-1.282 1.82-1.924 2.73a.128.128 0 01-.092.051c-.906-.007-1.813-.017-2.719-.028-.01 0-.02-.003-.04-.006a.455.455 0 01.025-.053 13977.496 13977.496 0 015.446-8.146c.092-.138.188-.273.275-.413a.165.165 0 00.018-.124c-.167-.515-.338-1.03-.508-1.543-.073-.22-.15-.44-.218-.66-.022-.072-.059-.094-.134-.093-.57.002-1.136.001-1.704.001-.108 0-.108 0-.108-.103 0-.674 0-1.347-.002-2.021 0-.075.026-.092.099-.092 1.143.002 2.286.002 3.43 0a.113.113 0 01.076.017.107.107 0 01.045.061 18266.184 18266.184 0 003.92 9.51c.218.53.438 1.059.654 1.59.026.064.053.076.12.056.6-.178 1.2-.352 1.8-.531.075-.023.102-.008.126.064.204.62.412 1.239.62 1.858l.02.073c-.043.015-.083.032-.124.043l-4.085 1.25c-.065.02-.085 0-.106-.054l-1.25-3.048-1.226-2.984-.183-.449c-.01-.026-.023-.048-.043-.087z"/>
                    </svg>
                </div>
                <div class="slide-pot-body">
                    <div class="slide-pot-slot"></div>
                    <div class="slide-pot-knob" data-led-mode="value">
                        <canvas class="slide-pot-knob-canvas" width="48" height="24"></canvas>
                    </div>
                </div>
                <div class="slide-pot-value">36</div>
            </div>
            <div class="slide-pot-container" data-param-id="lfo.freq" data-info-id="raembl-lfo-freq">
                <div class="slide-pot-label waveform-icon" data-param-label="FREQ" title="Frequency">
                    <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 4.5L6 7L6 5.25H18V7L21 4.5L18 2V3.75H6L6 2L3 4.5Z"/>
                        <path d="M6.63935 11.9367C7.14967 10.7061 8.89138 10.7018 9.4077 11.9299L12.735 19.8442C13.9443 22.7205 18.0283 22.6965 19.2036 19.8061L21.1579 15H18.9989L17.351 19.0527C16.8472 20.2915 15.0969 20.3018 14.5787 19.0691L11.2514 11.1548C10.0466 8.28919 5.98264 8.29911 4.79189 11.1706L3.20392 15H5.36906L6.63935 11.9367Z"/>
                    </svg>
                </div>
                <div class="slide-pot-body">
                    <div class="slide-pot-slot"></div>
                    <div class="slide-pot-knob" data-led-mode="value">
                        <canvas class="slide-pot-knob-canvas" width="48" height="24"></canvas>
                    </div>
                </div>
                <div class="slide-pot-value">5.0Hz</div>
            </div>
            <div class="slide-pot-container" data-param-id="lfo.waveform" data-info-id="raembl-lfo-wave">
                <div class="slide-pot-label waveform-icon" data-param-label="WAVE" title="Waveform">
                    <svg viewBox="0 0 512 512" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M212.898 79.91c-4.538 0-6.847 2.742-7.828 4.09-.98 1.348-1.34 2.29-1.69 3.207-.705 1.835-1.122 3.578-1.567 5.693-.892 4.23-1.71 9.75-2.536 16.442-1.65 13.384-3.268 31.297-4.71 50.232-2.88 37.87-5.036 79.37-5.036 96.428 0 15.474-2.12 45.862-4.958 71.846-.145 1.334-.31 2.47-.46 3.78-.114-1.007-.243-1.867-.356-2.89-2.838-25.672-4.957-56.006-4.957-72.736v-3.73l-.097-.094c-.243-18.42-2.25-46.27-4.973-70.89-1.45-13.11-3.073-25.12-4.767-34.16-.847-4.522-1.678-8.252-2.693-11.38-.508-1.564-1-2.953-1.99-4.62-.494-.832-1.094-1.772-2.34-2.872-1.243-1.1-3.534-2.506-6.51-2.506-3.054 0-5.366 1.47-6.6 2.592-1.234 1.12-1.82 2.065-2.305 2.902-.97 1.675-1.452 3.077-1.955 4.664-1.005 3.175-1.834 6.98-2.68 11.59-1.69 9.217-3.313 21.447-4.76 34.7-2.898 26.51-5.067 56.746-5.067 73.802 0 15.474-2.1 36.51-4.89 53.23-.177 1.064-.375 1.922-.558 2.95-.13-.733-.274-1.322-.402-2.075-2.784-16.39-4.885-37.375-4.887-54.107 0-18.202-2.186-39.73-5.138-57.117-1.477-8.693-3.122-16.29-4.942-22.187-.91-2.948-1.805-5.437-3.115-7.826-.654-1.194-1.38-2.39-2.737-3.73-1.36-1.34-3.826-3.162-7.432-3.162-3.76 0-6.24 1.956-7.573 3.33-1.334 1.374-2.033 2.583-2.672 3.8-1.28 2.43-2.166 4.982-3.07 8.01-1.803 6.056-3.443 13.862-4.916 22.692-2.948 17.66-5.136 39.137-5.136 56.193 0 15.474-2.085 30.537-4.748 41.266-.293 1.177-.605 2.073-.91 3.14-.89-2.847-1.715-6.005-2.3-9.787-1.76-11.345-2.236-25.753-2.687-39.983-.452-14.23-.848-28.235-2.977-39.875-1.065-5.82-2.498-11.1-5.22-15.83-2.724-4.73-7.54-9.197-13.716-10.274l-.767-.133h-.78c-4.603 0-7.32 2.488-8.988 4.354-1.668 1.865-2.75 3.763-3.785 5.886-2.072 4.245-3.78 9.44-5.315 15.63-3.072 12.374-5.277 28.546-5.277 45.602h18c0-15.473 2.084-30.536 4.748-41.266.624-2.51 1.29-4.736 1.94-6.7.528 1.685 1.036 3.684 1.455 5.97 1.72 9.397 2.24 22.992 2.69 37.205.452 14.213.863 29.093 2.89 42.17 2.027 13.077 5.084 25.195 15.132 32.406l2.352 1.69h2.895c4.603 0 7.322-2.488 8.99-4.354 1.668-1.867 2.75-3.765 3.785-5.888 2.072-4.245 3.776-9.44 5.312-15.628 3.073-12.375 5.28-28.548 5.28-45.604 0-15.475 2.1-36.51 4.888-53.23.178-1.064.376-1.92.56-2.948.13.732.272 1.32.4 2.073 2.782 16.39 4.884 37.375 4.884 54.103.002 18.205 2.19 39.733 5.143 57.12 1.475 8.695 3.118 16.293 4.938 22.19.91 2.947 1.807 5.436 3.117 7.825.655 1.194 1.38 2.392 2.74 3.73 1.357 1.34 3.824 3.162 7.43 3.162 3.763 0 6.24-1.956 7.575-3.33 1.333-1.374 2.03-2.583 2.67-3.8 1.278-2.43 2.165-4.982 3.068-8.01 1.805-6.056 3.446-13.862 4.92-22.692 2.946-17.66 5.134-39.137 5.134-56.193 0-15.474 2.12-45.862 4.96-71.846.145-1.333.31-2.47.458-3.78.116 1.01.245 1.87.358 2.892 2.838 25.672 4.96 56.006 4.96 72.734v3.73l.095.094c.243 18.422 2.25 46.272 4.972 70.893 1.45 13.11 3.074 25.12 4.768 34.16.847 4.52 1.677 8.248 2.693 11.377.508 1.564.998 2.953 1.988 4.62.496.832 1.098 1.774 2.342 2.874 1.245 1.1 3.534 2.504 6.51 2.504 3.054 0 5.365-1.47 6.6-2.592 1.234-1.12 1.82-2.065 2.304-2.902.97-1.675 1.453-3.077 1.955-4.664 1.006-3.175 1.835-6.982 2.68-11.59 1.69-9.217 3.314-21.447 4.762-34.7 2.896-26.51 5.064-56.746 5.064-73.802 0-15.475 2.132-57.52 4.988-95.063.132-1.74.282-3.268.418-4.987.11 1.415.236 2.662.345 4.092 2.857 37.238 4.988 79.227 4.988 95.955 0 18.205 2.158 59.76 5.04 97.334 1.44 18.787 3.058 36.476 4.71 49.678.825 6.6 1.642 12.04 2.537 16.217.447 2.087.867 3.81 1.58 5.637.356.914.722 1.857 1.717 3.2.994 1.342 3.32 4.023 7.783 4.023 4.538 0 6.845-2.742 7.826-4.09.982-1.348 1.34-2.29 1.692-3.207.704-1.835 1.123-3.578 1.57-5.693.89-4.23 1.707-9.75 2.532-16.442 1.65-13.384 3.27-31.296 4.71-50.23 2.88-37.87 5.036-79.368 5.036-96.424 0-15.475 2.132-57.52 4.988-95.065.132-1.735.28-3.26.416-4.973.112 1.41.237 2.654.346 4.08 2.855 37.238 4.984 79.23 4.984 95.957v9h.315c.402 20.462 2.157 54.84 4.725 88.33 1.44 18.787 3.06 36.476 4.71 49.678.827 6.6 1.646 12.038 2.54 16.215.448 2.088.867 3.812 1.58 5.64.357.914.723 1.857 1.717 3.2.995 1.342 3.323 4.023 7.783 4.023 4.54 0 6.848-2.744 7.83-4.092.98-1.348 1.338-2.29 1.69-3.207.703-1.834 1.12-3.576 1.566-5.69.892-4.23 1.71-9.75 2.535-16.442 1.65-13.384 3.266-31.296 4.707-50.23 2.88-37.868 5.04-79.37 5.04-96.424 0-15.475 2.118-45.864 4.958-71.848.145-1.333.31-2.47.46-3.78.114 1.01.243 1.87.356 2.892 2.838 25.67 4.96 56.004 4.96 72.734 0 18.204 2.17 48.495 5.067 74.715 1.45 13.11 3.074 25.12 4.768 34.16.848 4.52 1.68 8.25 2.694 11.377.508 1.564.997 2.953 1.987 4.62.496.832 1.098 1.772 2.342 2.872 1.245 1.1 3.533 2.506 6.51 2.506 3.054 0 5.366-1.47 6.6-2.592 1.234-1.12 1.82-2.065 2.305-2.902.97-1.675 1.452-3.077 1.955-4.664 1.005-3.175 1.836-6.982 2.68-11.59 1.69-9.217 3.315-21.447 4.763-34.7 2.897-26.51 5.066-56.746 5.066-73.802 0-15.475 2.1-36.51 4.89-53.23.177-1.06.374-1.917.557-2.942.13.73.273 1.317.4 2.066 2.783 16.39 4.885 37.376 4.885 54.106.002 18.205 2.19 39.733 5.142 57.12 1.477 8.695 3.12 16.293 4.94 22.19.91 2.946 1.807 5.434 3.117 7.823.656 1.194 1.38 2.39 2.737 3.73 1.358 1.34 3.827 3.162 7.434 3.162 3.764 0 6.242-1.956 7.575-3.33 1.333-1.374 2.03-2.583 2.67-3.8 1.28-2.43 2.166-4.982 3.07-8.01 1.803-6.056 3.443-13.862 4.916-22.692 2.948-17.66 5.136-39.137 5.136-56.193 0-15.474 2.085-30.538 4.748-41.268.238-.958.493-1.67.74-2.556.17.612.35 1.06.514 1.71 2.642 10.36 4.735 25.384 4.735 42.114 0 18.204 2.195 34.416 5.29 46.56 1.548 6.07 3.27 11.088 5.397 15.198 1.063 2.055 2.187 3.903 3.908 5.695 1.72 1.792 4.48 4.018 8.772 4.018 4.603 0 7.322-2.488 8.99-4.354 1.668-1.867 2.75-3.763 3.785-5.886 2.072-4.245 3.777-9.443 5.313-15.63 3.072-12.375 5.28-28.548 5.28-45.604h-18c0 15.474-2.085 30.538-4.75 41.268-.237.957-.493 1.666-.74 2.552-.17-.61-.346-1.06-.51-1.707-2.642-10.36-4.735-25.38-4.735-42.11 0-18.204-2.197-34.42-5.293-46.562-1.548-6.07-3.27-11.09-5.397-15.2-1.063-2.055-2.187-3.903-3.908-5.695-1.72-1.792-4.48-4.018-8.772-4.018-4.603 0-7.322 2.488-8.99 4.354-1.667 1.867-2.75 3.765-3.785 5.888-2.072 4.245-3.776 9.44-5.312 15.628-3.073 12.375-5.28 28.55-5.28 45.606 0 15.474-2.1 36.51-4.888 53.23-.177 1.062-.374 1.918-.557 2.944-.13-.73-.272-1.317-.4-2.067-2.783-16.392-4.886-37.378-4.888-54.11 0-18.203-2.186-39.73-5.14-57.117-1.475-8.694-3.12-16.292-4.94-22.188-.91-2.948-1.805-5.437-3.115-7.826-.655-1.195-1.38-2.393-2.74-3.73-1.357-1.34-3.826-3.163-7.432-3.163-3.764 0-6.24 1.957-7.575 3.332-1.333 1.373-2.03 2.582-2.67 3.797-1.278 2.43-2.164 4.982-3.066 8.01-1.804 6.056-3.445 13.862-4.918 22.692-2.946 17.658-5.135 39.135-5.135 56.192 0 15.474-2.118 45.862-4.958 71.846-.146 1.336-.31 2.475-.46 3.787-.116-1.01-.245-1.872-.358-2.897-2.838-25.67-4.958-56.005-4.96-72.736 0-18.203-2.17-48.494-5.067-74.713-1.45-13.11-3.072-25.12-4.766-34.16-.846-4.52-1.677-8.25-2.692-11.378-.508-1.564-1-2.952-1.99-4.617-.493-.833-1.094-1.775-2.338-2.875-1.245-1.1-3.535-2.506-6.512-2.506-3.054 0-5.365 1.47-6.6 2.592-1.234 1.12-1.82 2.065-2.304 2.902-.97 1.675-1.453 3.077-1.955 4.664-1.007 3.175-1.836 6.98-2.68 11.59-1.69 9.217-3.315 21.445-4.763 34.7-2.897 26.507-5.066 56.745-5.066 73.802 0 15.473-2.13 57.516-4.986 95.058-.132 1.735-.28 3.26-.416 4.975-.11-1.41-.236-2.653-.345-4.078-2.856-37.237-4.987-79.226-4.987-95.956v-9h-.314c-.403-20.46-2.157-54.842-4.725-88.332-1.44-18.787-3.06-36.477-4.71-49.68-.826-6.6-1.645-12.04-2.54-16.217-.447-2.088-.865-3.812-1.578-5.64-.357-.914-.725-1.857-1.72-3.2-.994-1.34-3.32-4.02-7.777-4.023h-.006c-4.536 0-6.846 2.745-7.826 4.092-.98 1.348-1.34 2.29-1.69 3.207-.704 1.836-1.123 3.578-1.57 5.692-.89 4.23-1.707 9.75-2.532 16.442-1.65 13.384-3.27 31.296-4.71 50.23-2.88 37.87-5.038 79.372-5.038 96.43 0 15.474-2.13 57.516-4.986 95.058-.132 1.732-.282 3.254-.416 4.965-.11-1.408-.235-2.648-.344-4.07-2.855-37.237-4.986-79.226-4.986-95.957 0-18.202-2.158-59.757-5.04-97.332-1.44-18.787-3.06-36.477-4.712-49.68-.826-6.6-1.643-12.04-2.537-16.217-.45-2.087-.868-3.81-1.582-5.637-.356-.914-.724-1.857-1.718-3.2-.995-1.342-3.32-4.023-7.782-4.023z"/>
                    </svg>
                </div>
                <div class="slide-pot-body">
                    <div class="slide-pot-slot"></div>
                    <div class="slide-pot-knob" data-led-mode="value">
                        <canvas class="slide-pot-knob-canvas" width="48" height="24"></canvas>
                    </div>
                </div>
                <div class="slide-pot-value waveform-icon">
                    <svg width="20" height="12" viewBox="0 0 24 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M1,7 Q4,1 7,7 T13,7 Q16,13 19,7 T23,7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
            </div>
            <div class="slide-pot-container" data-param-id="lfo.offset" data-bipolar="true" data-info-id="raembl-lfo-offset">
                <div class="slide-pot-label waveform-icon" data-param-label="OFFSET" title="Offset">
                    <svg viewBox="0 0 179.006 179.006" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <g transform="rotate(90 89.503 89.503)">
                            <polygon points="52.258,67.769 52.264,37.224 0,89.506 52.264,141.782 52.258,111.237 126.736,111.249 126.736,141.782 179.006,89.506 126.736,37.224 126.736,67.769"/>
                        </g>
                    </svg>
                </div>
                <div class="slide-pot-body">
                    <div class="slide-pot-slot"></div>
                    <div class="slide-pot-knob" data-led-mode="value">
                        <canvas class="slide-pot-knob-canvas" width="48" height="24"></canvas>
                    </div>
                </div>
                <div class="slide-pot-value">0</div>
            </div>
        </div>
    `;

    return lfoModule;
}

