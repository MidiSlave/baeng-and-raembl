// File: js/components/envelope.js
// Envelope module component - Updated for SlidePot
export function renderEnvelopeModule() {
    const envelopeModule = document.createElement('div');
    envelopeModule.id = 'raembl-envelope';
    envelopeModule.className = 'module';

    envelopeModule.innerHTML = `
        <div class="module-header-container">
            <button class="random-button" id="envelope-random" title="Randomize Envelope parameters">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="1" y="1" width="12" height="12" rx="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
                    <circle cx="3.5" cy="3.5" r="0.8" fill="currentColor"/>
                    <circle cx="10.5" cy="3.5" r="0.8" fill="currentColor"/>
                    <circle cx="3.5" cy="7" r="0.8" fill="currentColor"/>
                    <circle cx="10.5" cy="7" r="0.8" fill="currentColor"/>
                    <circle cx="3.5" cy="10.5" r="0.8" fill="currentColor"/>
                    <circle cx="10.5" cy="10.5" r="0.8" fill="currentColor"/>
                </svg>
            </button>
            <div class="module-header" data-info-id="raembl-module-envelope">ENVELOPE</div>
        </div>
        <div class="fader-section">
            <div class="slide-pot-container" data-param-id="envelope.attack" data-info-id="raembl-env-attack">
                <div class="slide-pot-label waveform-icon" data-param-label="A" title="Attack">
                    <svg viewBox="0 0 512 512" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M79.238 115.768l-28.51 67.863h406.15l-.273-67.862h-263.83v55.605h-15v-55.605h-16.68v55.605H146.1v-55.605h-17.434v55.605h-15v-55.605H79.238zm387.834 15.96v40.66h18.688v-40.66h-18.688zM56.768 198.63l20.566 32.015L28.894 406.5l101.68 7.174 21.54-97.996h115.74l14.664-80.252 174.55-3.873-.13-32.922H56.767zM263.44 235.85l-11.17 61.142h-96.05l12.98-59.05 12.53-.278-2.224 35.5 14.262 13.576 1.003-33.65 24.69-16.264 43.98-.976z"/>
                    </svg>
                </div>
                <div class="slide-pot-body">
                    <div class="slide-pot-slot"></div>
                    <div class="slide-pot-knob" data-led-mode="value">
                        <canvas class="slide-pot-knob-canvas" width="48" height="24"></canvas>
                    </div>
                </div>
                <div class="slide-pot-value">0%</div>
            </div>
            <div class="slide-pot-container" data-param-id="envelope.decay" data-info-id="raembl-env-decay">
                <div class="slide-pot-label waveform-icon" data-param-label="D" title="Decay">
                    <svg viewBox="0 0 512 512" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <g>
                            <path d="M512,81.174L430.826,0l-27.058,27.059l-13.529-13.529l-27.058,27.058l13.529,13.529l-18.978,18.98c-16.606-11.597-50.022-11.848-69.989,8.12L0,344.836L167.164,512L430.83,224.21c18.147-19.949,20.888-49.138,8.054-69.92L512,81.174z M165.955,456.674l-110.63-110.63l28.243-25.875l108.262,108.262L165.955,456.674z M402.569,198.41L217.703,400.19L111.808,294.296l201.732-184.819c6.291-6.291,19.198-9.138,26.189-2.147l64.94,64.941C410.823,178.422,409.841,190.416,402.569,198.41z M412.786,126.27l-27.058-27.058l45.096-45.097l27.059,27.059L412.786,126.27z"/>
                        </g>
                    </svg>
                </div>
                <div class="slide-pot-body">
                    <div class="slide-pot-slot"></div>
                    <div class="slide-pot-knob" data-led-mode="value">
                        <canvas class="slide-pot-knob-canvas" width="48" height="24"></canvas>
                    </div>
                </div>
                <div class="slide-pot-value">25%</div>
            </div>
            <div class="slide-pot-container" data-param-id="envelope.sustain" data-info-id="raembl-env-sustain">
                <div class="slide-pot-label waveform-icon" data-param-label="S" title="Sustain">
                    <svg viewBox="0 0 56 31" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <g transform="matrix(0.117858,0,0,0.117873,-1.4645,-24.78159)">
                            <path d="M 290,457.36218 C 290,471.1693 281.04569,482.36218 270,482.36218 C 258.95431,482.36218 250,471.1693 250,457.36218 C 250,443.55506 258.95431,432.36218 270,432.36218 C 281.04569,432.36218 290,443.55506 290,457.36218 L 290,457.36218 z" transform="matrix(2.375,0,0,1.9,-391.25,-445.376)"/>
                            <path d="M 15,467.36218 C 35,332.36218 130,212.36218 250,212.36218 C 370,212.36218 465,332.36218 485,467.36218 C 486,472.36218 461,472.36218 460,467.36218 C 435,372.36218 370,282.36218 250,282.36218 C 130,282.36218 65,372.36218 40,467.36218 C 39,472.36218 14,472.36218 15,467.36218 z"/>
                        </g>
                    </svg>
                </div>
                <div class="slide-pot-body">
                    <div class="slide-pot-slot"></div>
                    <div class="slide-pot-knob" data-led-mode="value">
                        <canvas class="slide-pot-knob-canvas" width="48" height="24"></canvas>
                    </div>
                </div>
                <div class="slide-pot-value">50%</div>
            </div>
            <div class="slide-pot-container" data-param-id="envelope.release" data-info-id="raembl-env-release">
                <div class="slide-pot-label waveform-icon" data-param-label="R" title="Release">
                    <svg viewBox="0 0 282.33 301.14" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M230.16,5.54c.15.47.51,1.48.55,1.66.11.43.52,2.92.55,3.33.17,1.67.14,4.4,0,6.1-.11.9-.36,2.42-.55,3.33-.02.09-.39,1.09-.55,1.66-.12.41-.39,1.18-.55,1.66-5.73,14.62-19.94,22.51-32.71,29.94-.29.16-.54.22-1.11.55-1.31.81-1.62-1.25-3.33,2.22-.69,1.41-.7.81,0,2.22,1.48,2.97,1.89,2.02,4.44,1.66,10.31-1.43,24.48-14.38,31.88-21.62.66,0,2.92,3.75,3.05,4.44.16.81.11,2.99,0,3.88-.01.11-.49,2.02-.55,2.22-2.76,8.07-16.93,15.1-24.4,18.3-.54.19-1.12.37-1.66.55s-1.14.38-1.66.55-1.18.41-1.66.55c-.72.21-1.41.31-2.22.55-.71.22-1.27.24-2.22.55-.70.24-1.34,0-2.77.55-3.89,1.5-5.67,3.65-1.11,6.1,2.1,1.13,2.36.02,2.77,0,1.39,0,2.18-.48,2.77-.55.82-.15,1.5-.4,2.22-.55.80-.18,1.45-.36,2.22-.55.63-.18,1.1-.37,1.66-.55.59-.19,1.06-.34,1.66-.55.55-.20.96-.28,1.66-.55,5.07-1.85,10.37-3.51,14.42-7.21h.55c-.53,1.07.54,2.11.55,2.22.21,1.24.12,4.19,0,5.54-.01.11-.42,1.57-.55,2.22-1.08,3.04-6.39,10.86-9.43,11.64-2.39.61-11.78.06-14.97,0-.46-.02-1.97-.55-3.33-.55-2.97-.11-7.56-1.35-5.54,3.88,1.11,2.88,1.14,1.67,3.33,2.22,1.5.38,2.46.33,3.88.55,2.01.35,3.58.35,5.54.55,2.6.31,5.1.92,7.76.55-3.60,7.04-9.35,12.44-16.63,15.53-.96.30-1.05.54-1.11.55-.61.15-1.85.49-2.22.55-.92.16-1.91.41-2.77.55-3.49.60-6.83-.55-10.53.55-.76.23-1.44-.37-2.22.83-.15.24.11,1.01,0,1.39-.75,2.49-.62,2.55,0,4.99.21.80.21.88.55,1.66,1.75,6.69,6.62,9.71,12.75,12.20.92.44,1.21.37,1.66.55.06.02.30.28,1.11.55.86.27,1.39.35,2.22.55.76.18,1.37.40,2.22.55,1.24.27,2.11.37,3.33.55,1.50.18,2.86.45,4.44.55,6.82.66,12.67.15,19.41,0,2.61,0,5.28-.51,7.76-.55,1.13.09,3.02-.25,3.88,0,.67.19,1.92,1.98,2.77,2.22v1.11c-1.17.46-2.25,2.35-3.33,2.77-.37.14-1.31.26-2.22.55-.76.24-3.52.49-4.44.55-.92.02-1.85,0-2.77,0-.20.01-2.46-.67-3.88-.55-1.22-.04-4.10-1.42-4.99,1.39-1.11,3.48,1.07,4,3.33,4.71,1.92.60,2.60.41,4.44.55,1.93.20,2.69,0,4.44,0,1.41.04,3.91.41,4.99-.55h.55c.54,2.74-3.22,7.14-5.54,7.76-.69.18-5.25.15-6.10,0-.09-.02-1.01-.38-1.66-.55-2.87-.77-6.97-4.40-10.53-4.99-3.08-.51-3.03-.69-3.88,2.22-.27.93-.24.22,0,1.11,1.10,3.99,6.50,4.96,9.98,6.65.91.44,1.42.43,1.66.55.89.45,1.59.51,1.66.55.06.04.46.77,1.11.83,0,.68-3.72,2.89-4.44,3.05-1.01.23-5.44.15-6.65,0-.11-.01-1.72-.43-2.22-.55-.18-.05-1.21-.41-1.66-.55-7.29-2.37-18.51-14.43-21.90-15.53-1.32-.43-2.89.55-3.05.55-2.49-.37-4.88.49-7.21.55-8.79-.02-18.52.56-27.17,0-1.15-.13-2.71-.36-3.88-.55-.82-.13-1.91-.38-2.77-.55-.61-.12-1.53-.39-2.22-.55s-1.55-.37-2.22-.55c-.31-.08-1.10-.38-1.66-.55-.49-.15-1.15-.38-1.66-.55-.59-.20-1.96-.79-2.77-1.11-11.81-5.52-23.19-15.51-28.28-27.72-.19-.45-.36-1.12-.55-1.66-.17-.47-.41-1.20-.55-1.66-.22-.73-.37-1.93-.55-2.77-.15-.72-.51-1.95-.55-2.22-.21-1.34-.43-3.11-.55-4.44-.62-8.67.27-17.31-.55-26.06-.12-1.78-.34-3.25-.55-4.99-.21-1.22-.23-2.04-.55-3.33-.18-.86-.31-1.38-.55-2.22-.21-.68-.25-.92-.55-1.66-2.54-7.06-4.13-8.76-11.09-11.64-.96-.49-1.31-.39-1.66-.55-1.07-.39-1.64-.36-2.22-.55s-1.07-.37-1.66-.55c-1.14-.45-1.68-.36-2.22-.55-1.03-.38-1.86-.41-2.22-.55-.72-.30-1.55-.49-1.66-.55-.18-.10-1.66-1.28-1.66-1.39,2.30-2.18,5.51-3.16,8.32-4.71.40-.17.86-.21,1.66-.55.38-.16.84-.20,1.66-.55.41-.18.62.08,1.66-.55,4.35-2.65,7.69-8.92,13.31-10.53.58-.17,1.58-.54,1.66-.55,1.51-.28,7.81-.23,9.43,0,.13.02,1.75.44,2.22.55.15.04,1.44.46,1.66.55,4.50,1.78,9.95,8.62,12.20,12.75.23.48.80,2.01,1.11,2.77.19.42.50.99.55,1.11.16.38.27.94.55,1.66.18.46.08,1.06.55,2.22.16.37.23.89.55,1.66.17.40.22.87.55,1.66.18.42.05,1.03.55,2.22.85,2.14,3.78,11.77,7.49,11.09,1.08-.20,12.54-12.53,16.08-14.97,6.36-4.39,13.87-7.71,20.79-11.09,2.57-1.25,5.60-2.03,8.32-3.33,2.47-1.19,5.88-1.96,8.59-3.33,16.26-8.20,27.99-24.21,37.15-39.37.40.04,2.78,4.80,3.05,5.54Z"/>
                        <path fill="#fdfdfd" d="M106.51,47.13c.08.34.08,1.32,0,1.66-1.37,5.77-11.68,3.21-8.32-3.05,1.84-3.41,7.56-1.78,8.32,1.39Z"/>
                        <path d="M270.08,158.02c.09.02,1.18.41,1.66.55,2.95.89,9.01,6.43,9.98,9.43.04.13.54,2.63.55,2.77.06.68.06,1.53,0,2.22-.01.14-1.11,1.77-.55,2.77-23.74,21.41-47.20,53.15-71.80,72.64-3.34,2.64-9.09,6.26-13.03,7.76-.55.16-1.58.54-1.66.55-.64.14-1.97.52-2.22.55-.85.13-2.40.52-2.77.55-17.10,1.72-39.34-.19-57.11,0-7.57-.11-23.87-2.16-30.50,0-2.59.84-8.02,7.76-8.59,7.76l-57.94-57.94c10.65-12.81,21.95-26.88,37.70-33.55.80-.28,1.05-.54,1.11-.55.53-.17,1.36-.47,1.66-.55.65-.18,1.58-.41,2.22-.55.83-.18,1.96-.42,2.77-.55,1.16-.20,2.73-.43,3.88-.55,3.12-.19,7.43-.22,10.53,0,1.25.08,3.12.38,4.44.55.98.13,2.32.37,3.33.55.40.07,1.47.40,2.22.55.64.14,1.53.39,2.22.55.19.05,1.02.38,1.66.55.31.08,1.06.38,1.66.55.50.15,1.67.75,2.77,1.11,4.24,1.52,7.49,3.60,12.20,4.99.06.02.02.26,1.11.55.97.33,1.47.34,2.22.55.37.11.81.36,1.66.55.29.04,1.14.44,2.22.55,15.78,2.24,34.02-1.33,49.35.55.43.05,2.13.42,2.77.55.59.13,1.65.38,2.22.55,3.11.98,12.48,7.25,13.31,10.53.13.53.13,3.91,0,4.44-.59,2.37-6.63,7.11-8.87,7.76-.37.11-2.33.49-2.77.55-21.24,3.07-49.06-2.76-70.97.55-3.48.58-2.73,5.17-.28,6.65,23.02-1.40,47.27,2.12,70.14-.55,1.43-.11,2.53-.35,3.88-.55.83-.14,1.50-.39,2.22-.55.85-.19,1.28-.44,1.66-.55.64-.19,1.05-.34,1.66-.55.57-.21.93-.25,1.66-.55,6.59-2.37,10.31-4.41,15.80-8.87,8.60-6.98,39.12-42.22,45.19-44.36.16-.06,2.04-.52,2.22-.55,1.19-.21,6.03-.21,7.21,0Z"/>
                        <path d="M94.31,276.68v1.11c-.33,1.56-20.99,22.10-22.46,22.73-1.04.45-2.18.76-3.33.55-4.83-.88-59.48-61.17-68.48-68.20.10-.69-.16-1.62,0-2.22.42-1.56,21.45-22.31,23.01-22.73.72-.20,1.94.13,2.77,0l68.48,68.75Z"/>
                    </svg>
                </div>
                <div class="slide-pot-body">
                    <div class="slide-pot-slot"></div>
                    <div class="slide-pot-knob" data-led-mode="value">
                        <canvas class="slide-pot-knob-canvas" width="48" height="24"></canvas>
                    </div>
                </div>
                <div class="slide-pot-value">75%</div>
            </div>
        </div>
    `;

    return envelopeModule;
}
